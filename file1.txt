Ver4
Some fixes
